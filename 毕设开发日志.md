# 毕设开发日志

## 一、接口文档



## 二、项目日志

### 1.2022-10-29~初始化项目

模仿的项目是 全球优惠券

**1.1导入sql文件**

只需在非注释的第一排，写入    use 数据库名;



**1.2npm报错**

 npm跑不起来，可能是你的npm和node版本对不上，就会包下面这种错误

```powershell
npm run dev 报错：Error: error:0308010C:digital envelope routines::unsupportednpm run dev 报错：Error: error:0308010C:digital envelope routines::unsupported
```

解决方案就是降低node版本，降到17.0.0以下就可以正常安装了



**1.3nvm报错**

使用nvm use时报下面这种错误就算权限不够

```powershell
exit status 1: ��û���㹻��Ȩ��ִ�д˲����� 
```



### 2.2022-11-29~选择模板项目

待考虑的有 vueStarter

commerce website

一个完整的电子商务网站前后台

blog项目，有koa写的接口、vue写得后台管理系统、vue+nuxt.js写得前台



**暂时决定选用blog项目**

```
module.exports = {
  environment: "dev",
  database: {
    dbName: "boblog",
    host: "127.0.0.1",
    port: 3306,
    user: "root",
    password: "pfq13568101942",
  },
  security: {
    secretKey: "secretKey",
    // 过期时间 1小时
    expiresIn: 60 * 60,
  },
};
```

很多项目都是要创建数据库的，右键 create schema 即可开始创建，创建完成后双击数据库即可完成链接数据库

![1670147550163](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\1670147550163.png)

```json
{
    "nickname":"coderpen",
    "email":"1592193136@qq.com",
    "password1":"123456_pfq",
    "password2":"123456_pfq"
}
```

![1670154684443](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\1670154684443.png)

管理员注册和登录接口已测试，没问题。



后台管理系统默认请求地址是别线上的，要把地址改为 本地:5000



### 3.好的想法

1.特效库

```
particles.js

vue-particles
```

2.利用书签做暗色主题

```
html{
filter:invert(1);
background:#fff;
}

img{
filter:invert(1);
}

变成一行粘贴到书签：javascript:
```

3.动画库

```
AOS.js
sal.js
```

4.hook工具合集

```
VueUse
```

5.githup使用技巧

```
在地址后面加1S，在vscode界面里面浏览代码
```

6.眼睛跟随做登录挺有趣的

```
watching-you
```



### 4.好的工具函数

4.1获取组件children中指定ref的方法

```js
export const getRef = (children, name) => {
  for (let i = 0; i < children.length; i++) {
    const ref = children[i].$refs[name];
    //console.log(ref, children[i], name, children[i].$children);
    if (ref) {
      return ref;
    }
    if (children[i].$children) {
      const childrenRef = getRef(children[i].$children, name);
      if (childrenRef) {
        return childrenRef;
      }
    }
  }
  return null;
};

例子：
  //基础信息表单验证
  const addEditResBasicForm = getRef(
    state.dialogsRef.$children,
    "addEditResBasicForm"
  );
```



4.2将对象数组中的唯一值作为隐射item的键

```js
//提供数组转map，可以用key获取formItem或其他数组元素，不需要遍历
export const arrayToMap = (arr, key) => {
  const map = {};
  arr.forEach((item) => {
    map[item[key]] = item;
  });
  return map;
};
```



### **5.好的源码**

基于vue开发网易云播放器，

```
https://github.com/qier222/YesPlayMusic
```

专门分享开源项目的网站,hellogithub.com

```
https://hellogithub.com/periodical/volume
```

免费编程书的库

```
justjavac/free-programming-books-zh_CN
```

github排行榜

```
GrowingGit/GitHub-Chinese-Top-Charts
```



### 6.好的插件&快捷键

**6.1 JSDoc注释**

```
/**  
先写函数方法，参数，然后在添加/**,回车，回车之后会自动提取部分内容，然后手动完善。

或者安装Document This ，光标放置于function上面，快捷键是 Ctrl+Alt+D 
```

**6.2Turbo Console Log**

快速添加 console.log 信息，js debug 必备

快捷键和书签那个冲突了。。。

ctrl + alt + l 选中变量之后，使用这个快捷键生成 console.log

alt + shift + c 注释所有 console.log

alt + shift + u 启用所有 console.log

alt + shift + d 删除所有 console.log



**6.3css-auto-prefix和css peek**

一个是自动做兼容，一个是查看定义



**6.4Draw.io integration**

画图插件



### 7.2023.1.31~增加注册字段

dao文件是放操作数据访问对象的类

![1675177046584](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\1675177046584.png)



## 三、论文日志

### 1.吸收其他论文中的优点

#### 1.1商品管理系统_余锦铭

1.在研究背景及意义中 先从传统消费观念的转换然后引出存在的问题最后将课题的意义描述出来。 思路清晰√

2.研究内容写的专业 √

3.软件架构的理论整的详细 √

4.数据库字段设计的展示很清晰 √

5.系统实现章节在展示各个模块时，将功能点依次列出来，虽然人家是抄的，但是论文写得好，值得学习  √

6.在写接口时将众所周知的支持的请求方法，返回状态说明写了上去，增加字数的好方法 √ 可以写出koa2的好处

7.token实现步骤详细，加了代码，反正老师不懂 √ 我可以将token的组成用图文展示出来，越详细越专业

8.系统测试章节还整了个表，于前面的模块一一对应 √



#### 1.2游戏商城网站_吴梓凯

1.在摘要中提出根据需求调研设计功能，提到了SPA页面的作用 √我可以写SSR的优点

2.实现目标中提到了SSL加密

3.游戏功能模块图将前后台页面整体的展示了出来，功能描述时将前后台分开来描述 √

4.在需求分析中用到了同行业的对比数据，需求调研写得很详细且对实现自己的网站提供了想法 √

5.这个原型设计到位，ER图点睛之笔 √

6.数据库中表设计的展示，用的表格，描述比较啰嗦但可以凑字数 √

7.网站开发直接粘贴的代码，展示图直接上图



#### 1.3作业管理系统_郑鹏

1.相关技术描述章节提到了RESULTful软件架构和B/S架构模式，websocket也描述得到位 √

2.需求分析章节中的技术可行性分析写得到位 √

3.系统测试整得专业 √

4.结论写中写出的收获丰富且真实 √



### 2.完成需求分析和模块设计

只能将后台管理的注册和前台网站分开实现了，头疼



### 3.大致理解毕设，完成初稿

#### 3.1koa2笔记

- 路由插件 koa-router中间件
- 获取git参数，query返回是格式化好的参数对象，querystring返回的是请求字符串，由于ctx对request的API有直接引用的方式，所以获取GET请求数据有两个途径：ctx.query，ctx.request.query。
- 获取post请求的参数需要解析原生node.js请求对象req
- 注意：ctx.request是context经过封装的请求对象，ctx.req是context提供的node.js原生HTTP请求对象，同理ctx.response是context经过封装的响应对象，ctx.res是context提供的node.js原生HTTP响应对象。
- 对于POST请求的处理，koa-bodyparser中间件可以把koa2上下文的formData数据解析到ctx.request.body中



- 读写cookie，ctx.cookies.get(name, [options]) 
- 实现session需要第三方中间件，数据量小直接存内存，大的话需要存储介质
- koa加载模板引擎，需安装koa-views与ejs
- koa实现上传文件



- async/await封装使用mysql
- 通常初始化数据库要建立很多表，特别在项目开发的时候表的格式可能会有些变动，这时候就需要封装对数据库建表初始化的方法，保留项目的sql脚本文件，然后每次需要重新建表，则执行建表初始化程序就行
- mysql模块是node操作MySQL的引擎，可以在node.js环境下对MySQL数据库进行建表，增、删、改、查等操作。数据库会话



koa的中间件流程控制，是一个典型的洋葱模型，它可以保证中间件的执行顺序。Koa的洋葱模型是以next()函数为分割点，先由外到内执行Request的逻辑，然后再由内到外执行Response的逻辑，这里的request的逻辑，我们可以理解为是next之前的内容，response的逻辑是next函数之后的内容，也可以说每一个中间件都有两次处理时机。洋葱模型的核心原理主要是借助compose方法。  **真假值得探究**




#### 3.2cookie与session

![1674656236154](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\1674656236154.png)

1.什么是cookie
Cookie意为“甜饼”，是由W3C组织提出，最早由Netscape社区发展的一种机制。目前Cookie已经成为标准，所有的主流浏览器如IE、Netscape、Firefox、Opera等都支持Cookie。

2.为什么要用cookie
由于http协议是一种无状态的协议（客户端和服务端互相不认识）

Cookies是一些存储在用户电脑上的小文件。它是被设计用来保存一些站点的用户数据，这样能够让服务器为这样的用户定制内容。页面代码能够获取到Cookie值然后发送给服务器，比如Cookie中存储了所在地理位置，以后每次进入地图就可以默认定位到改地点。

3.cookie的原理
cookie的执行原理：就是当客户端访问服务器的时候（服务器运用了cookie），服务器会生成一份cookie传输给客户端，客户端会自动把cookie保存起来，以后客户端每次访问服务器，都会自动的携带着这份cookie。

简单来说，就是当客户端访问服务器时，服务器会生成一个票据给客户端，当客户端收到票据的之后就保存起来，以后再访问服务器就会自动带着票据。



#### 3.3ORM框架Sequelize

要连接到数据库,必须创建一个 Sequelize 实例. `Sequelize` 是指库本身,而 `sequelize` 是指 Sequelize 的实例,它表示与一个数据库的连接. 这是官方推荐的约定,在整个文档中都将遵循.

**特点：**

- 强大的模型定义，支持虚拟类型。
- 支持完善的数据验证，减轻前后端的验证压力。
- Sequelize的查询非常全面和灵活



**lib：**

1. 安装MySQL：npm install mysql2
2. 安装Sequelize：npm install sequelize



**模型同步：**

在 Sequelize 中可以用两种等效的方式定义模型：

1.调用 sequelize.define(modelName, attributes, options)
2.扩展 Model 并调用 init(attributes, options)



**查找器：**

默认情况下，所有finder方法的结果都是模型类的实例（而不仅仅是普通的JavaScript对象）。这意味着在数据库返回结果后，Sequelize会自动将所有内容包装在适当的实例对象中。在少数情况下，当结果太多时，这种包装可能效率低下。要禁用此包装并接收普通响应，请将｛raw:true｝作为选项传递给finder方法。



**模型作用域：**

```js
    scopes: {
      bh: {
        // 模型作用域，重用代码
        attributes: {
          // 查找器对象，排除下面的属性
          exclude: ['password', 'updated_at', 'deleted_at', 'created_at']
        }
      },
      iv: {
        attributes: {
          exclude: ['content', 'password', 'updated_at', 'deleted_at']
        }
      }
    }
```



记得将论文发微信上，上班没事时写

### 4.补充模块，完善毕设

#### 4.1待完成的模块

- 1.交流系统和信息中心
- 2.可以从前台发布文章
- 3.小卖部
- 4.后台管理系统对应的功能
- 5.在**首页加个轮播图，放上学校照片**
- 6.有时间可以把**眼睛跟随**那个写上去
- 7.还得把宿舍和这个联系起来！！！不只是发布信息，在登录那可以用学号登录



#### 4.2模板功能分析

原来是一个博客，意思是后台管理系统压根就没有做权限管理.....



#### 4.3功能原型设计

得沿着要解决的核心痛点来设计功能了，早知道先找好项目在写开题报告，真是搬起石头砸自己的脚

1. 与宿舍有很强的关联性-------->**登录时增加昵称和宿舍号学号**
2. 信息传递不便 -------->实现**聊天系统**？？ ------->
3. 商务行为不能统一管理 --------> 得给**后台管理系统增加权限**  ----->
4. 商务体系不完善 --------> 整个**宿舍小卖部**，搞点**标签**啥D2-4053，然后整个官方小卖部 ------>**对应的后台管理**呢？



可以复制文章表当做是商品表呀，先把mysql快速过一遍，然后研究一下文章表，然后把小卖部搞了，再搞个信息中心、上传文章的页面。不用考虑外键，表之间的耦合性太高，现在都是采用增加一个关系表来操作。比如user表和goods，在加一个购物车表，放userID，goodsID。不就关联起来了吗。



chatGPT无法使用时，把localStorage里面`@@auth0spajs`开头的删除就欧克了，也可以在url处输入：

```js
javascript:window.localStorage.removeItem(Object.keys(window.localStorage).find(i=>i.startsWith('@@auth0spajs')))
```



#### 4.4参考文章

关于nxut.js的文章

```
https://zhuanlan.zhihu.com/p/89484871
```



#### 4.5上传到githup

```powershell
git add .
git commit -m "basic change"
git branch -M main
git remote set-url origin https://github.com/pengpen1/koa_dormalm.git
git push -u origin main
```



### 5.完善论文

#### 5.1ORM流程图完善

![1674721784944](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\1674721784944.png)

![1674722080772](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\1674722080772.png)

![1674722516205](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\1674722516205.png)